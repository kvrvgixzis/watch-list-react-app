(this["webpackJsonpwatch-list-react-app"]=this["webpackJsonpwatch-list-react-app"]||[]).push([[0],{30:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(8),a=n(3),s=(n(30),function(){var e=Object(a.c)((function(e){return e.app.alert}));return e&&e.trim()?Object(c.jsx)("div",{className:"notification",role:"alert",children:e}):null}),i=function(){return Object(c.jsx)("div",{className:"spinner-border text-danger",role:"status",children:Object(c.jsx)("div",{className:"sr-only",children:"Loading..."})})},o=n(11),l=n(4),u=n.n(l),j=n(6),d=n(1),b="https://via.placeholder.com/".concat(200,"x").concat(400,"?text=Poster+not+found"),p=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,c,r,a,s,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c={originalTitle:"",posterUrl:b},t){e.next=3;break}return e.abrupt("return",c);case 3:return t=t.split(" ").join("%20"),r="https://api.themoviedb.org/3/search/multi?api_key=".concat("eeddb6b3c7a58009b97b8dde8b85c32d","&query=").concat(t,"&&language=ru"),e.next=7,fetch(r);case 7:return a=e.sent,e.next=10,a.json();case 10:if(null===(s=e.sent)||void 0===s||null===(n=s.results)||void 0===n?void 0:n.length){e.next=13;break}return e.abrupt("return",c);case 13:return i=s.results[0],console.log("".concat(t,": "),i),o=i.poster_path,c.posterUrl="http://image.tmdb.org/t/p/w500/".concat(o),c.originalTitle=i.original_title,c.overview=i.overview,e.abrupt("return",c);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(e){var t=e.film,n=Object(d.useState)(void 0),r=Object(o.a)(n,2),a=r[0],s=r[1];return Object(d.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t.title);case 2:n=e.sent,s(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]),a?Object(c.jsxs)("div",{className:"card",children:[Object(c.jsx)("img",{src:a.posterUrl,className:"card__poster",alt:"poster"}),Object(c.jsxs)("div",{className:"card__about",children:[Object(c.jsx)("h3",{className:"card__heading",children:t.title}),Object(c.jsx)("h3",{className:"card__heading-original",children:a.originalTitle}),Object(c.jsx)("p",{className:"card__type",children:t.type}),Object(c.jsxs)("p",{className:"card__overview",children:[Object(c.jsx)("strong",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435: "}),a.overview]}),Object(c.jsxs)("p",{className:"card__comment",children:[Object(c.jsx)("strong",{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439: "}),t.comment]}),Object(c.jsxs)("p",{className:"card__author",children:[Object(c.jsx)("strong",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u043b: "}),t.added_by]})]})]}):null},O=(n(32),n(33),function(){var e=Object(a.c)((function(e){return e.films.films}));return Object(a.c)((function(e){return e.app.loading}))?Object(c.jsx)(i,{}):e.length?Object(c.jsx)("div",{className:"grid",children:e.map((function(e){return Object(c.jsx)(f,{film:e},e.id)}))}):Object(c.jsx)("div",{children:"\u0424\u0438\u043b\u044c\u043c\u043e\u0432 \u043d\u0435\u0442 \xaf\\_(\u30c4)_/\xaf"})}),m=n(10),h=n(2),v="FILM/CREATE_POST",x="FILM/FETCH_FILMS",_="FILM/DELETE_FILM",g="APP/SHOW_LOADER",y="APP/HIDE_LOADER",N="APP/SHOW_ALERT",w="APP/HIDE_ALERT",E="APP/SHOW_ADD_FORM",A="APP/HIDE_ADD_FORM";function k(e){return function(t){t({type:N,payload:e}),setTimeout((function(){t({type:w})}),2e3)}}var P="https://my-json-server.typicode.com/kvrvgixzis/watch-list-react-app/films";n(34),n(35);var S=function(e){var t=e.title,n=e.clickHandler;return Object(c.jsx)("button",{onClick:n,className:"btn",children:t})},L=function(){var e=Object(d.useState)({title:"",comment:""}),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(d.useRef)(),i=Object(a.b)(),l=Object(a.c)((function(e){return e.app.isAddFormShow})),b=function(e){var t=e.target;r((function(e){return Object(h.a)(Object(h.a)({},e),{},Object(m.a)({},t.name,t.value))}))};return Object(d.useEffect)((function(){var e=function(e){var t=e.target;l&&s.current&&!s.current.contains(t)&&i({type:A})};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[s,i,l]),l?Object(c.jsx)("div",{className:"form",children:Object(c.jsxs)("form",{ref:s,className:"form__body",onSubmit:function(e){e.preventDefault(),r((function(e){return Object(h.a)(Object(h.a)({},e),{},{title:"",comment:""})}));var t=Date.now().toString();i(function(e){return function(){var t=Object(j.a)(u.a.mark((function t(n){var c,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(P,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:return c=t.sent,t.next=5,c.json();case 5:r=t.sent,console.log("json: ",r),n({type:v,payload:e});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(Object(h.a)(Object(h.a)({},n),{},{id:t})))},children:[Object(c.jsx)("h5",{className:"form__title",children:"\u0427\u0442\u043e \u043f\u043e\u0441\u043e\u0432\u0435\u0442\u0443\u0435\u0448\u044c?"}),Object(c.jsxs)("div",{className:"form__inputs",children:[Object(c.jsx)("input",{className:"form__input",name:"title",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:n.title,onChange:b}),Object(c.jsxs)("select",{name:"type",onChange:b,className:"form__input",children:[Object(c.jsx)("option",{select:"true",children:"\u041a\u0438\u043d\u043e"}),Object(c.jsx)("option",{children:"\u0421\u0435\u0440\u0438\u0430\u043b"}),Object(c.jsx)("option",{children:"\u041c\u0443\u043b\u044c\u0442\u0444\u0438\u043b\u044c\u043c"}),Object(c.jsx)("option",{children:"\u041c\u0443\u043b\u044c\u0442\u0441\u0435\u0440\u0438\u0430\u043b"}),Object(c.jsx)("option",{children:"\u0410\u043d\u0438\u043c\u0435"})]}),Object(c.jsx)("textarea",{className:"form__input",placeholder:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",value:n.comment,name:"comment",id:"comment",rows:10,onChange:b}),Object(c.jsx)("input",{className:"form__input",name:"added_by",type:"text",placeholder:"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c\u0441\u044f",value:n.added_by,onChange:b})]}),Object(c.jsx)(S,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",type:"submit"})]})}):null},D=(n(36),function(){var e=Object(a.b)();return Object(c.jsxs)("header",{className:"header",children:[Object(c.jsx)("div",{className:"header__title",children:"\u0427\u0442\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c?"}),Object(c.jsx)("div",{className:"header__right-pane",children:Object(c.jsx)(S,{clickHandler:function(){console.log("Hello"),e({type:E})},title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})}),F=(n(37),function(){return Object(c.jsx)("footer",{className:"footer",children:"by nktpfn"})}),T=(n(38),function(e){var t=e.children;return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)(D,{}),Object(c.jsx)("main",{className:"root",children:t}),Object(c.jsx)(F,{})]})}),H=function(){return Object(c.jsxs)(T,{children:[Object(c.jsx)(s,{}),Object(c.jsx)(L,{}),Object(c.jsx)(O,{})]})},I=(n(39),n(5)),C=n(18),R={loading:!1,alert:null,isAddFormShow:!1},M=n(16),J={films:[]},U=Object(I.c)({films:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(h.a)(Object(h.a)({},e),{},{films:[t.payload].concat(Object(M.a)(e.films))});case _:return Object(h.a)(Object(h.a)({},e),{},{films:Object(M.a)(e.films.filter((function(e){return e.id!==t.payload})))});case x:return Object(h.a)(Object(h.a)({},e),{},{films:t.payload});default:return e}},app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(h.a)(Object(h.a)({},e),{},{loading:!0});case y:return Object(h.a)(Object(h.a)({},e),{},{loading:!1});case N:return Object(h.a)(Object(h.a)({},e),{},{alert:t.payload});case w:return Object(h.a)(Object(h.a)({},e),{},{alert:null});case E:return Object(h.a)(Object(h.a)({},e),{},{isAddFormShow:!0});case A:return Object(h.a)(Object(h.a)({},e),{},{isAddFormShow:!1});default:return e}}}),W=Object(I.e)(U,Object(I.d)(Object(I.a)(C.a,(function(e){var t=e.dispatch;return function(e){return function(n){if(n.type===v){var c=n.payload,r=c.title,a=c.comment;if(!r.trim())return t(k("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"));if(!a.trim())return t(k("\u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"))}return e(n)}}}))));W.dispatch(function(){var e=Object(j.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:g}),e.prev=1,e.next=4,fetch(P);case 4:return n=e.sent,e.next=7,n.json();case 7:c=e.sent,t({type:x,payload:c}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t(k("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435"));case 14:t({type:y});case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()),Object(r.render)(Object(c.jsx)(a.a,{store:W,children:Object(c.jsx)(H,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.bfc0ed60.chunk.js.map